				                    	  <fieldset class="container">	  			 			  <div ng-controller="MyController" class="my-controller">			  <div class="pull-right">					  </div>	 	    <div class="row">	      <div class="col-lg-12 col-md-12 container">	          <div class="row">            	            <div class="col-md-6 col-xs-6" style="margin-top:13px;">	          	            </div>	            <div class="col-md-6 col-xs-6" style="margin-top:10px;">		  	<form class="pure-form" method="post" action="/staff_warehouse_filter" align="right">		  	  		  	               <label for="filterby" class="pfont">By:</label>		  	               <select  id="filterby" name="filterby">		  					    <!--IF ALL SHOW DATE SELECT OPTIONS-->		  					   <option value="All">All</option>		  					    <!--IF CONSIGNEE SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY CONSIGNEE -->		  	                   <option value="Consignee">Consignee</option>		  					    <!--IF SHIPPER SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY SHIPPER-->		  	                   <option value="Shipper">Shipper</option>		  					    <!--IF RECEIPT # SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY RECEIPT-->		  	                   <option value="Receipt">Receipt #</option>		  					   <!--IF BY DATE ONLY SHOW DATE SELECT OPTIONS-->		  	                   <option value="Date">Date</option>		  					      <!--IF TRANSPORT SHOW DATE SELECT OPTIONS AND INPUT TO SPECIFY TRANSPORT-->		  	                   <option value="Transport">Transport</option>                                              		  	                   <option value="Invoice">Invoice</option>		  	                   <option value="Country">Country</option>		  	                   <option value="Warehouse">WareHouse</option>		  	                   <option value="volume">Volume</option>                       		  	               </select>		  				   <!-- IF ALL OR DATE SELECTED THIS SEARCH INPUT IS NOT USE-->		  				   <input type="hidden" placeholder="Search"  id="searchtext" name="searchtext">				   		  				   <label class="pfont">Date:</label>		  				   <select id="filterdate" name="filterdate">		  					   <option value="All">All</option>		  					   <option value="Today">Today</option>		  					   <option value="Yesterday">Yesterday</option>		  					   <option value="This week">This week</option>		  					   <option value="This month">This month</option>		  					   <option value="Last month">Last month</option>			  					   <option value="Current year">Current Year</option>		  				   </select>			   		  	        <button type="submit" class="pure-button pure-button-primary">Search</button>		  			  	</form>				            </div>	          </div>	          	          <div class="panel">	            <div class="panel-body">	              <ul id="list">                                          <%include labelsTableDynamic.ejs %>                  	              </ul>	            </div>	          </div>	         	        </div>	         	      </div>	    </div>	  </fieldset>	  	  	   <script>               function date_condition()    {        if($("#filterdate").val() == "Today")        {            var now = new Date();            now.setHours(0,0,0,0);                        nowbegin = new Date(now.getTime()  );            nowbegin.setHours(0,0,0,0);                        var time = (24 * 3600 * 1000)-1000;            var nowend = new Date(now.getTime() + (time) );            nowend.setHours(0,0,0,0);                                return {                    greaterThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowbegin}},                    lessThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowend}}                    };        }        else if($("#filterdate").val() == "Yesterday")        {            var now = new Date();            now.setHours(0,0,0);                        var difftime = (24 * 3600 * 1000); // one day                        nowbegin = new Date(now.getTime() - difftime - (1000) );                        var time = (24 * 3600 * 1000)-1000;            var nowend = new Date(now.getTime() - difftime + (time) );                                    return {                    greaterThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowbegin}},                    lessThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowend}}                    };        }        else if($("#filterdate").val() == "This week")        {                        var now = new Date();            now.setHours(0,0,0);                        //dia de la semana            var nday = now.getDay()+1;  //index zero based                        var difftime = nday * (24 * 3600 * 1000); // number of day to substract to current date                        nowbegin = new Date(now.getTime() - difftime - (1000) );                        var time = (24 * 3600 * 1000)-1000;            var nowend = new Date(now.getTime() + (time) );                        return {                    greaterThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowbegin}},                    lessThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowend}}                    };        }        else if($("#filterdate").val() == "This month")        {                        var now = new Date();            now.setHours(0,0,0);                        //dia del mes            var nday = now.getDate()-1;                        var difftime = nday * (24 * 3600 * 1000); // number of day to substract to current date                        nowbegin = new Date(now.getTime() - difftime - (1000) );                        var time = (24 * 3600 * 1000)-1000;            var nowend = new Date(now.getTime() + (time) );                        return {                    greaterThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowbegin}},                    lessThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowend}}                    };        }        else if($("#filterdate").val() == "Last month")        {                        var now = new Date();            now.setHours(0,0,0);            now.setDate(0);                        //mes del anio            //var n = now.getMonth()-1;                        nowbegin = new Date(now.getTime() - (1000) );            nowbegin.setMonth(now.getMonth()-1 );                        var time = (24 * 3600 * 1000)-1000;            var nowend = new Date(now.getTime() + (time) );                        return {                    greaterThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowbegin}},                    lessThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowend}}                    };        }        else if($("#filterdate").val() == "Current year")        {            var now = new Date();            now.setHours(0,0,0);                        nowbegin = new Date(now.getTime() - (1000) );            nowbegin.setDate( 1 );            nowbegin.setMonth(0);                        var nowend = new Date(now.getTime() );            nowend.setHours(23,59,59);                        return {                    greaterThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowbegin}},                    lessThanOrEqualTo: {'ReceiptDate' : {__type:"Date", iso:nowend}}                    };        }                return {};    }                function filter_conditions()    {        //DATE INTERVAL        if($("#filterby").val() == "Date")        {            var begindate = new Date(req.body.searchtext);            var enddate = new Date(req.body.filterdate);                        return {                    greaterThan: {'ReceiptDate' : {__type:"Date", iso:begindate}},                    lessThan: {'ReceiptDate' : {__type:"Date", iso:enddate}}                    };        }        else        {             return date_condition();        }        }        function filter_like()    {                        if($("#filterby").val() == "Transport"  || $("#filterby").val() == "Country" || $("#filterby").val() == "Warehouse" || $("#filterby").val() == "Invoice")        {            var dic = {};            dic[$("#filterby").val()] = $("#searchtext").val();            return dic;        }        else if($("#filterby").val() == "Shipper")        {            var dic = {};            dic[$("#filterby").val()] = {"Name":$("#searchtext").val()};            return dic;        }        else if($("#filterby").val() == "Consignee")        {            return {"Consignee":{"Name":$("#searchtext").val()}};        }            }                      function searchtext_keyup()        {                    InsertTable({                    cols:   /*Columnas definidas FIELD:TITLE or FIELD:{FIELDNEEDED:FIELDTITLE}*/                         {                                                        "Receipt":"",                            "Shipper":{"Name":""}, /*This is the sintax for return fields of pointers showed on table*/                            "ReceiptDate":"",                            "Country":"",                            "Volume":"",                            "Warehouse":"",                            "Invoice":"",                            "Transport":""                        },                                            /* AL PASAR EL PARAMETRO COLLECTION INDICAMOS QUE NECESITAMOS BUSQUEDA CON LISTA DE RESULTADOS */                    collection: "Warehouses", /* COLLECCION PRINCIPAL */                                                            /* CONDICIONES */                    conditions: filter_conditions(),                                        /*BUSQUEDA DE SEARCH TIPO LIKE*/                    like: filter_like(),                                        document: "staff_RepackDynamicTable",                    itemid: "repack_table"                });                    }            	  	$("#filterdate").change(function(){                                                InsertTable({                    cols:   /*Columnas definidas FIELD:TITLE or FIELD:{FIELDNEEDED:FIELDTITLE}*/                         {                                                        "Receipt":"",                            "Shipper":{"Name":""}, /*This is the sintax for return fields of pointers showed on table*/                            "ReceiptDate":"",                            "Country":"",                            "Volume":"",                            "Warehouse":"",                            "Invoice":"",                            "Transport":""                        },                                            /* AL PASAR EL PARAMETRO COLLECTION INDICAMOS QUE NECESITAMOS BUSQUEDA CON LISTA DE RESULTADOS */                    collection: "Warehouses", /* COLLECCION PRINCIPAL */                                                            /* CONDICIONES */                    conditions: filter_conditions(),                                        /*BUSQUEDA DE SEARCH TIPO LIKE*/                    like: filter_like(),                                        document: "staff_RepackDynamicTable",                    itemid: "repack_table"                });        });               $("#filterby").change(function(){		  		if($("#filterby").val() == "Date")	  		{	  			$("#searchtext").replaceWith("<input type='text'  placeholder='From' id='searchtext' name='searchtext'>");            	              $("#filterdate").replaceWith("<input type='text'  placeholder='To' id='filterdate' name='filterdate'>");                            $( "#searchtext" ).datepicker();                $( "#filterdate" ).datepicker();	  		}	          else if($("#filterby").val() == "volume")	  		{            	  			$("#searchtext").replaceWith("<input type='text' placeholder='Search' id='searchtext' name='searchtext'><select id='volumecond' name='volumecond'><option value='lessthan'>Less than</option><option value='greaterthan'>Greater Than</option><option value='equal'>Equal</option></select>");	              $("#filterdate").replaceWith("<select id='filterdate' name='filterdate'><option value='All'>All</option><option value='Today'>Today</option> <option value='Yestarday'>Yesterday</option><option value='This week'>This week</option><option value='This month'>This month</option><option value='Last month'>Last month</option><option value='Current year'>Current Year</option></select>");            	          }	          else if($("#filterby").val() == "All")	  		{            	  			$("#searchtext").replaceWith("<input type='hidden' placeholder='Search' id='searchtext' name='searchtext'>");	              $("#filterdate").replaceWith("<select id='filterdate' name='filterdate'><option value='All'>All</option><option value='Today'>Today</option> <option value='Yestarday'>Yesterday</option><option value='This week'>This week</option><option value='This month'>This month</option><option value='Last month'>Last month</option><option value='Current year'>Current Year</option></select>");            	          }	          else	          {	  			$("#searchtext").replaceWith("<input type='text' placeholder='Search' id='searchtext' name='searchtext'>");                $("#filterdate").replaceWith("<select id='filterdate' name='filterdate'><option value='All'>All</option><option value='Today'>Today</option> <option value='Yestarday'>Yesterday</option><option value='This week'>This week</option><option value='This month'>This month</option><option value='Last month'>Last month</option><option value='Current year'>Current Year</option></select>");                $("#searchtext").keyup(searchtext_keyup);	          }	  	});	    	  </script>	  